---
const reviews = [
	{
		name: "Sarah Johnson",
		rating: 5,
		text: "AC ECO CLEAN & CONTRUCT transformed our office space! The team is professional, thorough, and uses eco-friendly products. Highly recommend!",
		location: "Downtown Office Building"
	},
	{
		name: "Michael Chen",
		rating: 5,
		text: "We've been using their services for over a year now. Consistent quality, always on time, and our home has never looked better.",
		location: "Residential Home"
	},
	{
		name: "Emily Rodriguez",
		rating: 5,
		text: "The deep cleaning service was exceptional. They paid attention to every detail and left our home spotless. Worth every penny!",
		location: "Family Home"
	},
	{
		name: "David Thompson",
		rating: 5,
		text: "Professional, reliable, and affordable. The move-out cleaning was perfect - we got our full security deposit back thanks to them!",
		location: "Apartment Complex"
	},
	{
		name: "Lisa Anderson",
		rating: 5,
		text: "As a business owner, I appreciate their attention to detail and flexibility. They work around our schedule and always deliver excellent results.",
		location: "Commercial Space"
	}
];
---

<div class="relative bg-white py-16">
	<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
		<div class="text-center mb-12">
			<h2 class="text-3xl font-bold text-primary mb-4">What Our Customers Say</h2>
			<p class="text-lg text-gray-600">Trusted by thousands of satisfied clients</p>
		</div>

		<!-- Review Slider Container -->
		<div class="relative overflow-hidden" id="review-slider-wrapper">
			<div id="review-slider" class="flex transition-transform duration-500 ease-in-out" style={`width: ${reviews.length * 100}%;`}>
				{reviews.map((review) => (
					<div class="review-slide flex-shrink-0 px-4" style={`width: ${100 / reviews.length}%;`}>
						<div class="bg-gray-50 rounded-lg p-8 shadow-sm border-t-4 border-accent">
							<!-- Stars -->
							<div class="flex justify-center mb-4">
								{Array.from({ length: review.rating }).map(() => (
									<svg class="w-6 h-6 text-accent" fill="currentColor" viewBox="0 0 20 20">
										<path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" />
									</svg>
								))}
							</div>

							<!-- Review Text -->
							<p class="text-gray-700 text-center mb-6 text-lg italic">
								"{review.text}"
							</p>

							<!-- Reviewer Info -->
							<div class="text-center">
								<p class="font-semibold text-gray-900">{review.name}</p>
								<p class="text-sm text-gray-500">{review.location}</p>
							</div>
						</div>
					</div>
				))}
			</div>
		</div>

		<!-- Navigation Dots -->
		<div class="flex justify-center mt-8 space-x-2">
			{reviews.map((_, index) => (
				<button
					class={`review-dot w-3 h-3 rounded-full transition-all ${
						index === 0 ? 'bg-accent' : 'bg-gray-300'
					}`}
					data-index={index}
					aria-label={`Go to review ${index + 1}`}
				></button>
			))}
		</div>

		<!-- Navigation Arrows -->
		<button
			id="prev-review"
			class="absolute left-4 top-1/2 -translate-y-1/2 bg-white rounded-full p-3 shadow-lg hover:bg-gray-50 transition-colors"
			aria-label="Previous review"
		>
			<svg class="w-6 h-6 text-gray-700" fill="none" stroke="currentColor" viewBox="0 0 24 24">
				<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
			</svg>
		</button>
		<button
			id="next-review"
			class="absolute right-4 top-1/2 -translate-y-1/2 bg-white rounded-full p-3 shadow-lg hover:bg-gray-50 transition-colors"
			aria-label="Next review"
		>
			<svg class="w-6 h-6 text-gray-700" fill="none" stroke="currentColor" viewBox="0 0 24 24">
				<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
			</svg>
		</button>
	</div>
</div>

<script define:vars={{ totalReviews: reviews.length }}>
	let currentReview = 0;
	const slider = document.getElementById('review-slider');
	const dots = document.querySelectorAll('.review-dot');
	const prevButton = document.getElementById('prev-review');
	const nextButton = document.getElementById('next-review');

	function updateSlider() {
		if (slider) {
			const slidePercent = 100 / totalReviews;
			slider.style.transform = `translateX(-${currentReview * slidePercent}%)`;
		}
		
		dots.forEach((dot, index) => {
			if (index === currentReview) {
				dot.classList.remove('bg-gray-300');
				dot.classList.add('bg-accent');
			} else {
				dot.classList.remove('bg-accent');
				dot.classList.add('bg-gray-300');
			}
		});
	}

	function nextReview() {
		currentReview = (currentReview + 1) % totalReviews;
		updateSlider();
	}

	function prevReview() {
		currentReview = (currentReview - 1 + totalReviews) % totalReviews;
		updateSlider();
	}

	if (prevButton) {
		prevButton.addEventListener('click', prevReview);
	}

	if (nextButton) {
		nextButton.addEventListener('click', nextReview);
	}

	dots.forEach((dot, index) => {
		dot.addEventListener('click', () => {
			currentReview = index;
			updateSlider();
		});
	});

	// Set initial position and sync dots
	updateSlider();

	// Auto-advance every 5 seconds
	setInterval(nextReview, 5000);
</script>

<style>
	#review-slider-wrapper {
		/* Constrain so only one slide is visible; slider moves inside */
		contain: layout style;
	}

	#review-slider {
		display: flex;
		will-change: transform;
	}

	.review-slide {
		box-sizing: border-box;
	}

	@media (max-width: 768px) {
		#prev-review,
		#next-review {
			display: none;
		}
	}
</style>
